## ss -ant | grep -v "LISTEN" | awk 'NR>1 && $4 !~ /:8080$/ && match($4, /:([0-9]+)$/, a) && a[1] > 1024 && $5 != "*:*"' |wc -l
1100
## ss -ant | grep -v "LISTEN" | awk 'NR>1 && $4 !~ /:8080$/ && match($4, /:([0-9]+)$/, a) && a[1] > 1024 && $5 != "*:*"' | awk '{print $1}' | sort | uniq -c | awk '{printf "%-10s: %d\n", $2, $1}'
CLOSE-WAIT: 1
ESTAB     : 1308
## ss -ant | grep -v "LISTEN" | awk 'NR>1 && $4 !~ /:8080$/ && match($4, /:([0-9]+)$/, a) && a[1] > 1024 && $5 != "*:*" {print $5}' | sort | uniq -c | sort -n
1 108.177.125.188:5228
1 20.50.80.210:443
1 44.219.148.160:443
542 10.2.3.215:80
662 10.2.3.172:80
## ss -ant | grep -v "LISTEN" | awk 'NR>1 && $4 ~ /:8080$/' |wc -l
4007
## ss -ant | grep -v "LISTEN" | awk 'NR>1 && $4 ~ /:8080$/' | awk '{count[$1]++} END {for (state in count) print state": "count[state]""}'
CLOSE-WAIT: 2
ESTAB: 4004
TIME-WAIT: 1
## ss -ant | grep -v "LISTEN" | awk 'NR>1 && $4 ~ /:8080$/' | awk '{print $5}' | cut -d[ -f2 | cut -d] -f1 | cut -d: -f4 | sort | uniq -c | sort -n
3 10.2.12.70
9 10.2.3.207
999 10.2.3.205
999 10.2.3.209
1000 10.2.3.206
1000 10.2.3.208